---
title: "R Notebook"
output: html_notebook
---
```{r}
library(tidyverse)
library(infer)
data(msleep)
```


Question 1.
Explore the dataset and familiarise yourself with it.
```{r}
summary(msleep)

```



Question 2.
Jabberwockies sleep for around 7 hours a night, on average. Perform an appropriate statistical test to determine whether the mean sleep_total in the sampled population of animal types differs from the typical value for jabberwockies.
$$
H0: \mu_{Jabberwockies\ sleep\ length} = \mu_{animals\ sleep\ length}\\
H1: \mu_{Jabberwockies\ sleep\ length} \neq \mu_{animals\ sleep\ length}\\
$$

```{r}
null_distribution<- msleep %>%
  specify(response = sleep_total) %>%
  hypothesise(null = 'point', mu = 7) %>% 
  generate(reps = 1000, type = "bootstrap") %>%
  calculate(stat = "mean")

null_distribution
```

```{r}
observed_stats <- mean(msleep$sleep_total, na.rm = TRUE)

null_distribution %>% 
  visualise() +
  shade_p_value(obs_stat = observed_stats, direction = 'both')
```

```{r}
p_value <- null_distribution %>% 
  get_p_value(obs_stat = observed_stats, direction = "both")
p_value
```


Question 3.
Perform an appropriate statistical test to determine whether omnivores sleep for significantly longer than herbivores, on average.
$$
H0: \mu_{omnivores\ sleep\ length} = \mu_{herbivores\ sleep\ length}\\
H1: \mu_{omnivores\ sleep\ length} > \mu_{herbivores\ sleep\ length}\\
$$
```{r}
null_distribution_2 <- msleep %>% 
  filter(vore %in% c("omni", "herbi")) %>% 
  specify(sleep_total ~ vore) %>% 
  hypothesize(null = "independence") %>% 
  generate(reps = 1000, type = "permute") %>% 
  calculate(stat = "diff in means", order = c("omni", "herbi")) 

null_distribution_2

```
```{r}
observed_stat_2 <- msleep %>% 
  filter(vore %in% c("omni", "herbi")) %>% 
  specify(sleep_total ~ vore) %>% 
  calculate(stat = "diff in means", order = c("omni", "herbi"))
  
observed_stat_2
```
```{r}
null_distribution_2 %>%
  visualise() +
  shade_p_value(obs_stat = observed_stat_2, direction = "right")
```
```{r}
p_value_2 <- null_distribution_2 %>%
  get_p_value(obs_stat = observed_stat_2, direction = "right")

p_value_2
```


Question 4. Perform an appropriate statistical test to determine whether the proportion of domesticated animal types in the population of animal types is greater than 5%.
Hint
Think about creating an is_domesticated variable for the analysis
$$
H0: \pi_{domestic} = 0.05\\
H1: \pi_{domestic} \neq 0.05\\
$$

```{r}
msleep_dome <- msleep %>%
  mutate(is_domesticated = conservation == "domesticated",
         .after = conservation) %>% 
  drop_na(is_domesticated)
#dropped na because it doesn't like NAs in the specify later 
msleep_dome
```

```{r}
null_distribution_3 <- msleep_dome %>%
  specify(response = is_domesticated, success = "TRUE") %>% 
  hypothesize(null = "point", p = 0.05) %>%
  generate(reps = 1000, type = "draw") %>%
  calculate(stat = "prop") 

null_distribution_3
```
```{r}
observed_stats_prop <- msleep_dome %>% 
  specify(response = is_domesticated, success = "TRUE") %>% 
  calculate(stat = "prop")

observed_stats_prop
```
```{r}
null_distribution_3 %>% 
  visualise(bins = 12) +
  shade_p_value(obs_stat = observed_stats_prop, direction = 'both')
```
```{r}
p_value_prop <- null_distribution_3 %>%
  get_p_value(obs_stat = observed_stats_prop, direction = "both")

p_value_prop
```


Question 1.
You work for a independent coffee shop. The boss tells you that she thinks that around 40% of people in the town (population 30,000) know of the coffee shop, but you are skeptical of the estimate. You conduct a random survey of 200 people in the town, asking if respondents are aware of your coffee shop. You want to use the sample to test the hypothesis that 40% or more of the town’s population have heard of the coffee shop.

+one sample hypothesis test of proportion 

+H0:40% of the poeple in the town of 30,000 know about the coffee shop 
H1:The percentage of the poeple in the town of 30,000 that know about the coffee 
shop is not 40%. 
$$
H0: \pi_{know\ the \ shop } = 0.4\\
H1: \pi_{know\ the\ shop} > 0.4
$$
+ draw to generate 


Question 2.
You work for a website design company and have performed an A/B test on the position of a banner on a website promoting a particular item.

A/B testing A method comparing two versions of a web page, email, flyer or other marketing device against each other to determine which version performs better. As it is essentially a controlled experiment, the design should try to ensure that the groups experiencing both versions of the marketing device are equivalent and representative of the population.



You selected five days at random last month and then randomly selected 200 of each sampled day’s users into group A and another 200 of that day’s users into group B. Group A continued to be shown the banner at the right hand side of the webpage (its usual position) while group B was shown the banner at the top of the page. You monitored each sampled user’s interactions with the website, in particular the ‘click through rate’ (CTR) on the banner, i.e. what proportion of sampled users clicked on the banner. You want to use the sampled data to test the hypothesis that website users overall are more likely to click on the banner if positioned at the top of the page

+two sample hypothesis test of proportion 
+H0: The proportion of poeple clicked on the web banner in group A
is the same as in group B 
H1: The proportion of peopel clicked on the web banner in group B (top of the page
is higher than the percentage in group A(right hand side)
$$
H0: \pi_{groupB\ click} - \pi_{groupA\ click} = 0 \\
H1: \pi_{groupB\ click} - \pi_{groupA\ click} > 0 
$$
+permutation to generate 



Question 3.
You work as an analyst for a car manufacturing company - they have specific standards they must meet for standards and regulation purposes. You have been asked to check the quality control of the manufacture of a particular car part. You have been given data on a sample of 200 parts produced over the period of a week (the sampled parts were pulled at random from the production line and measured: the factory produced a lot more than 200 parts that week). The specification of the part stipulates a width of 145mm, and the manufacturing process is said to have ‘drifted’ if the mean width of parts differs significantly from 145mm. You want to use the sampled measurements to test whether the process overall has drifted.

+one sample hypothesis test of mean 
+H0: The mean width of parts that are made this week are the same as 145mm
H1: The mean width of parts that are made this week are not the same as 145mm
$$
H0: \mu_{width\ of\ the\ parts} = 145\\
H1: \mu_{width\ of\ the\ parts} \neq 145
$$
+boostrap to generate 



1.3 Hypothesis Testing - Interpreting the results
For the 3 business problems stated above, imagine we performed you got the following p-values (with the given significance levels) write out your interpretation of the results.


Question 1.

Coffee shop problem. Significance level: 0.05, calculated p-value: 0.07

P-value > 0.05, we don'r reject H0, no evidence to support H1, 
people in the town know about the coffee shop is not signicantly different 
from 40%


Question 2.

Website company problem. Significance level: 0.01, p-value: 0.006

P_value < 0.01, we reject H0, evidence support H1, 
Group A and B has siginicant different amount of clicks. 
it's likely that group B has more click than group A 


Question 3.

Manufacturing company problem. Significance level: 0.05, p-value: 0.55

P_value > 0.05, we don't reject H0, no evidence to support H1, 
it's likely that the width of the parts are not significantly different 
from 145 mm. 
